>经过上一章的学习，我们已经能够编写一条合格的sql注入语句，然后我们使用这个注入语句能做什么事情。

## 识别数据库系统
我们首先，需要识别数据库是什么数据库，是mysql、sql server还是Oracle。
### 基于服务
1. 基于web服务器：  
    + 如果是asp、.net通常都是sql server；
    + php应用通常是mysql或者postgreSQL；
    + 如果是java编写，通常是oracle、Mysql数据库
    
2. 基于底层操作系统
    + windows架构，通常是sql server
    + 运行Apache、PHP的linux操作系统，通常是开源数据库（Mysql、PostgreSQL）
    
### 非盲跟踪
    


1. 查看数据库的报错信息；
<img src="http://wujiashuaitupiancunchu.oss-cn-shanghai.aliyuncs.com/jupyter_notebook_img/zekxlk3zex.png" width="600px" />

2. 获取标志信息
<img src="http://wujiashuaitupiancunchu.oss-cn-shanghai.aliyuncs.com/jupyter_notebook_img/1g7z6ntnbmgj.png" width="600px" />

<img src="http://wujiashuaitupiancunchu.oss-cn-shanghai.aliyuncs.com/jupyter_notebook_img/7g51oed0bnd.png" width="600px" />


其中除了包含数据库的系统版本外，还有数据库的精确版本和补丁级别，还包含了安装其上的操作系统的版本信息。
注入@@version：  
为检索数据库版本,可以向name参数注入下列内容
<img src="http://wujiashuaitupiancunchu.oss-cn-shanghai.aliyuncs.com/jupyter_notebook_img/fvb50nu2d57.png" width="400px" />
最终其查询会变成
<img src="http://wujiashuaitupiancunchu.oss-cn-shanghai.aliyuncs.com/jupyter_notebook_img/lr7g91i64c.png" width="400px" />

其他内置变量： 
<img src="http://wujiashuaitupiancunchu.oss-cn-shanghai.aliyuncs.com/jupyter_notebook_img/6pbzi791pi5.png" width="600px" />

<img src="http://wujiashuaitupiancunchu.oss-cn-shanghai.aliyuncs.com/jupyter_notebook_img/h5wwaklltk6.png" width="600px" />


### 盲追踪

1. 从字符串推测数据库版本信息
<img src="http://wujiashuaitupiancunchu.oss-cn-shanghai.aliyuncs.com/jupyter_notebook_img/hsalo7lenxq.png" width="600px" />

2. 使用每个数据库系统特定的函数
<img src="http://wujiashuaitupiancunchu.oss-cn-shanghai.aliyuncs.com/jupyter_notebook_img/i9n4zxqyhom.png" width="600px" />

3. Mysql 特殊方法进行确认
    + 在行尾加上一个#
    + 在行末尾加上个"-- "（值得注意的是，第二个连字符号后面有空格）；
    + 在注释中间跟上数据库版本以及一个运算式
    <img src="http://wujiashuaitupiancunchu.oss-cn-shanghai.aliyuncs.com/jupyter_notebook_img/5oqiu4761ep.png" width="600px" />

## 使用UNION提取数据
>使用union之前需要满足以下条件：
1. 两个查询范围的列数必须相同
2. 两个select语句返回的数据类型必须相同

### 匹配列数
即判断第一个select一共有几列
1. 使用NULL
举一个例子
<img src="http://wujiashuaitupiancunchu.oss-cn-shanghai.aliyuncs.com/jupyter_notebook_img/0x4q3wezb6hg.png" width="600px" />
直到不返回错误位置  

由于Oracle，select的时候必须加上表，则需要稍微改变一下
<img src="http://wujiashuaitupiancunchu.oss-cn-shanghai.aliyuncs.com/jupyter_notebook_img/0d96h6z7yggi.png" width="600px" />
其中dual是一张所有用户都能访问的表
2. 使用order by
<img src="http://wujiashuaitupiancunchu.oss-cn-shanghai.aliyuncs.com/jupyter_notebook_img/yl5nqz7u8f.png" width="600px" />
这个原理就在于order by既可以跟具体的列名称，也可以跟列所在的列数。所以order by 1就是按照第一列排序

### 匹配数据类型

获取到列数，之后我们就要判断每列的数据类型，即哪一列是可以放字符串，哪一列是自能放数字
<img src="http://wujiashuaitupiancunchu.oss-cn-shanghai.aliyuncs.com/jupyter_notebook_img/q06x35eo6c.png" width="600px" />
如果，不报错。则这一行可以放置字符串。


### 获取数据
我们以及知道列数以及每一列的数据类型。然后就可以获取数据了。
1. 使用数据库内置变量与函数获取数据
<img src="http://wujiashuaitupiancunchu.oss-cn-shanghai.aliyuncs.com/jupyter_notebook_img/ovl5zyqo1xe.png" width="600px" />
其中system_user就是内置变量。可以获取数据库当前用户。db_name()可以获取当前数据库的名称。

2. 使用连接符获取在有限的空间内获取最多的数据
使用"|"，如下面的URL所示
<img src="http://wujiashuaitupiancunchu.oss-cn-shanghai.aliyuncs.com/jupyter_notebook_img/ln2dqhie30s.png" width="600px" />

结果
<img src="http://wujiashuaitupiancunchu.oss-cn-shanghai.aliyuncs.com/jupyter_notebook_img/fn7dbvalwzq.png" width="400px" />

3. 使用sql查询语句
```sql

```

### 获取整张数据
